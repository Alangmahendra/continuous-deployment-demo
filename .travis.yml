sudo: false
language: python
env:
- PATH=$PATH:$HOME/gcloud/google-cloud-sdk/bin PYTHONPATH=${HOME}/gcloud/google-cloud-sdk/platform/google_appengine
before_install:
- openssl aes-256-cbc -K $encrypted_45d1b36fa803_key -iv $encrypted_45d1b36fa803_iv -in credentials.tar.gz.enc -out credentials.tar.gz -d
- tar -xzf credentials.tar.gz
- mkdir -p lib
install:
- pip install -r requirements.txt -t lib/
script:
- gcloud -q preview app deploy app.yaml --set-default 
- python e2e_test.py
deploy:
    skip_cleanup: true
    provider: gae
    keyfile: client-secret.json
    project: continuous-deployment-python
    default: true
    on:
      all_branches: true
